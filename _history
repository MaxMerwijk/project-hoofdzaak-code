{"entries":[{"timestamp":1749545969366,"editorVersion":"7.0.61","changes":[{"type":"edited","filename":"main.blocks","patch":[{"diffs":[[0,"http"],[-1,"s"],[0,"://"],[-1,"developers.google.com/blockly/xml\"><variables></variables>"],[1,"www.w3.org/1999/xhtml\">\n  "],[0,"<blo"]],"start1":12,"start2":12,"length1":70,"length2":37},{"diffs":[[0,"art\""],[-1," x=\"0\" y=\"0\""],[0,"></b"]],"start1":67,"start2":67,"length1":20,"length2":8},{"diffs":[[0,"</block>"],[1,"\n  "],[0,"<block t"]],"start1":72,"start2":72,"length1":16,"length2":19},{"diffs":[[0,"ver\""],[-1," x=\"205\" y=\"0\""],[0,"></b"]],"start1":107,"start2":107,"length1":22,"length2":8},{"diffs":[[0,"</block>"],[1,"\n"],[0,"</xml>"]],"start1":112,"start2":112,"length1":14,"length2":15}]},{"type":"edited","filename":"main.ts","patch":[{"diffs":[[-1,"basic.forever(function () {\n\t\n})"],[0,"\n"]],"start1":0,"start2":0,"length1":33,"length2":1}]},{"type":"edited","filename":"pxt.json","patch":[{"diffs":[[0," \"*\""],[-1,",\n        \"Huskylens\": \"github:dfrobot/pxt-dfrobot_huskylens#v2.0.7\""],[0,"\n   "]],"start1":144,"start2":144,"length1":76,"length2":8},{"diffs":[[0,"   \""],[-1,"preferredEditor\": \"blocksprj\""],[1,"additionalFilePaths\": []"],[0,"\n}\n"]],"start1":241,"start2":241,"length1":36,"length2":31}]}]},{"timestamp":1749546077169,"editorVersion":"7.0.61","changes":[{"type":"edited","filename":"pxt.json","patch":[{"diffs":[[0,"itor\": \""],[-1,"t"],[1,"block"],[0,"sprj\"\n}\n"]],"start1":324,"start2":324,"length1":17,"length2":21}]}]},{"timestamp":1749550291884,"editorVersion":"7.0.61","changes":[{"type":"edited","filename":"pxt.json","patch":[{"diffs":[[0,"0.7\""],[-1,",\n        \"MaqueenPlus\": \"github:dfrobot/pxt-dfrobot-maqueenplus#v1.5.1\""],[0,"\n   "]],"start1":212,"start2":212,"length1":80,"length2":8}]}]},{"timestamp":1749550329951,"editorVersion":"7.0.61","changes":[{"type":"edited","filename":"main.ts","patch":[{"diffs":[[-1,"// ---------- VARIABLES ----------\nlet helmetDetected: boolean = false\nlet manualControlActive: boolean = false\nlet lastGamepadCommandTime: number = 0\nconst GAMEPAD_TIMEOUT_MS: number = 1000 // If no command for 1 sec, assume gamepad is idle\n\n// ---------- CONSTANTS ----------\nconst HELMET_ID: number = 1 // << IMPORTANT: Change this if your helmet is learned as a different ID\n\n// ---------- INITIALIZATION ----------\n// Initialize Maqueen Plus V2\nmaqueenPlusV2.I2CInit() // Initializes I2C for Maqueen's own sensors, also enables I2C bus\n\n// Initialize HuskyLens\nhuskylens.initI2c() // Uses P19 (SCL), P20 (SDA) by default\nhuskylens.initMode(protocolAlgorithm.OBJECTCLASSIFICATION) // << USE THIS FOR HELMETS\n\n// Radio Setup\nradio.setGroup(1) // Choose a radio group (e.g., 1)\n\n// Initial status display\nbasic.showIcon(IconNames.Happy)\nmaqueenPlusV2.ledBlank(maqueenPlusV2.controlLED(1,)) // Turn off Maqueen LEDs initially\n\n// ---------- MAIN LOOP ----------\nbasic.forever(function () {\n    // 1. Request data from HuskyLens\n    huskylens.request()\n\n    // 2. Check for helmet detection\n    // isLearned(ID) checks if the ID has been taught to the HuskyLens\n    // isAppear(ID, type) checks if that specific learned ID is currently visible\n    if (huskylens.isLearned(HELMET_ID) && huskylens.isAppear(HELMET_ID, HUSKYLENSResultType_t.HUSKYLENSResultBlock)) {\n        if (!helmetDetected) { // Only do these actions on the first detection\n            helmetDetected = true\n            maqueenPlusV2.controlMotorStop(maqueenPlusV2.MyEnumMotor.AllMotor) // Stop the car\n            maqueenPlusV2.controlLED(maqueenPlusV2.MyEnumLed.AllLed, maqueenPlusV2.MyEnumSwitch.Open) // Turn ON Maqueen's onboard LEDs\n            basic.showIcon(IconNames.No) // Indicate helmet detected\n        }\n    } else {\n        if (helmetDetected) { // Only do these if it was previously detected\n            helmetDetected = false\n            maqueenPlusV2.controlLED(maqueenPlusV2.MyEnumLed.AllLed, maqueenPlusV2.MyEnumSwitch.Close) // Turn OFF Maqueen's onboard LEDs\n            basic.clearScreen() // Clear icon (or show something else)\n            // If gamepad was active, it will resume control via radio handler.\n            // If gamepad is idle, car will remain stopped (see below).\n        }\n    }\n\n    // 3. Handle gamepad timeout\n    // If no command from gamepad for a while, and no helmet, stop the car.\n    if (!helmetDetected && manualControlActive && (input.runningTime() - lastGamepadCommandTime > GAMEPAD_TIMEOUT_MS)) {\n        manualControlActive = false\n        maqueenPlusV2.controlMotorStop(maqueenPlusV2.MyEnumMotor.AllMotor)\n        basic.showIcon(IconNames.Asleep) // Indicate gamepad timed out\n    }\n\n    // If no helmet and gamepad is not active, ensure car is stopped.\n    if (!helmetDetected && !manualControlActive) {\n        maqueenPlusV2.controlMotorStop(maqueenPlusV2.MyEnumMotor.AllMotor)\n        // You could clear the icon or show a \"waiting\" icon if basic.clearScreen() above is too blank\n    }\n    basic.pause(50) // Small delay to prevent overwhelming the system\n})\n\n// ---------- RADIO RECEPTION (from Gamepad) ----------\nradio.onReceivedString(function (receivedString: string) {\n    lastGamepadCommandTime = input.runningTime() // Update timestamp for timeout\n    manualControlActive = true\n\n    if (helmetDetected) {\n        // If helmet is detected, stop motors and ignore gamepad movement commands\n        maqueenPlusV2.controlMotorStop(maqueenPlusV2.MyEnumMotor.AllMotor)\n        basic.showIcon(IconNames.No) // Re-assert helmet detection display\n        return // Exit early\n    }\n\n    // If no helmet, process gamepad commands\n    basic.showLeds(`\n        . . . . .\n        . . # . .\n        . # . # .\n        . . # . .\n        . . . . .\n        `) // Indicate radio command received and being processed\n\n    if (receivedString == \"F\") {\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.AllMotor, maqueenPlusV2.MyEnumDir.Forward, 150) // Speed 0-255\n    } else if (receivedString == \"B\") {\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.AllMotor, maqueenPlusV2.MyEnumDir.Backward, 150)\n    } else if (receivedString == \"L\") {\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.LeftMotor, maqueenPlusV2.MyEnumDir.Backward, 100)\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.RightMotor, maqueenPlusV2.MyEnumDir.Forward, 100)\n    } else if (receivedString == \"R\") {\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.LeftMotor, maqueenPlusV2.MyEnumDir.Forward, 100)\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.RightMotor, maqueenPlusV2.MyEnumDir.Backward, 100)\n    } else if (receivedString == \"S\") {\n        maqueenPlusV2.controlMotorStop(maqueenPlusV2.MyEnumMotor.AllMotor)\n    } else if (receivedString == \"LED_L_ON\") {\n        maqueenPlusV2.controlLED(maqueenPlusV2.MyEnumLed.LeftLed, maqueenPlusV2.MyEnumSwitch.Open)\n    } else if (receivedString == \"LED_L_OFF\") {\n        maqueenPlusV2.controlLED(maqueenPlusV2.MyEnumLed.LeftLed, maqueenPlusV2.MyEnumSwitch.Close)\n    } else if (receivedString == \"LED_R_ON\") {\n        maqueenPlusV2.controlLED(maqueenPlusV2.MyEnumLed.RightLed, maqueenPlusV2.MyEnumSwitch.Open)\n    } else if (receivedString == \"LED_R_OFF\") {\n        maqueenPlusV2.controlLED(maqueenPlusV2.MyEnumLed.RightLed, maqueenPlusV2.MyEnumSwitch.Close)\n    }\n    // Add more commands for RGB LEDs if desired, e.g., using maqueenPlusV2.rgb()\n    // e.g., if (receivedString == \"RGB_RED\") { maqueenPlusV2.setBrightness(100); maqueenPlusV2.rgb(100,0,0) }\n})"],[1,"basic.forever(function () {\n\t\n})\n"]],"start1":0,"start2":0,"length1":5571,"length2":33}]},{"type":"edited","filename":"pxt.json","patch":[{"diffs":[[0,"       \""],[-1,"m"],[1,"M"],[0,"aqueenPl"]],"start1":219,"start2":219,"length1":17,"length2":17},{"diffs":[[0,"Plus"],[-1,"V2"],[0,"\": \""]],"start1":234,"start2":234,"length1":10,"length2":8},{"diffs":[[0,"-dfrobot"],[-1,"_"],[1,"-"],[0,"maqueenp"]],"start1":260,"start2":260,"length1":17,"length2":17},{"diffs":[[0,"plus"],[-1,"_v20#v2.2.20"],[1,"#v1.5.1"],[0,"\"\n  "]],"start1":276,"start2":276,"length1":20,"length2":15}]}]},{"timestamp":1749550929386,"editorVersion":"7.0.61","changes":[{"type":"edited","filename":"main.ts","patch":[{"diffs":[[0,"T_ID"],[-1,"S"],[0,": number"],[-1,"[]"],[0," = "],[-1,"[1, 2, 3, 4] // << Adjust to match your helme"],[1,"1 // << IMPORTANT: Change this if your helmet is learned as a differen"],[0,"t ID"],[-1,"s"],[0,"\n\n//"]],"start1":289,"start2":289,"length1":72,"length2":93},{"diffs":[[0,"---\n"],[-1,"maqueenPlusV2.I2CInit()\nhuskylens.initI2c()\nhuskylens.initMode(protocolAlgorithm.OBJECTCLASSIFICATION)\nradio.setGroup(1)\nbasic.showIcon(IconNames.Happy)\n\n// ---------- HELPER FUNCTION ----------\nfunction isAnyH"],[1,"// Initialize Maqueen Plus V2\nmaqueenPlusV2.I2CInit() // Initializes I2C for Maqueen's own sensors, also enables I2C bus\n\n// Initialize HuskyLens\nhuskylens.initI2c() // Uses P19 (SCL), P20 (SDA) by default\nhuskylens.initMode(protocolAlgorithm.OBJECTCLASSIFICATION) // << USE THIS FOR HELMETS\n\n// Radio Setup\nradio.setGroup(1) // Choose a radio group (e.g., 1)\n\n// Initial status display\nbasic.showIcon(IconNames.Happy)\nmaqueenPlusV2.ledBlank(maqueenPlusV2.controlLED(1,)) // Turn off Maqueen LEDs initially\n\n// ---------- MAIN LOOP ----------\nbasic.forever(function () {\n    // 1. Request data from HuskyLens\n    huskylens.request()\n\n    // 2. Check for h"],[0,"elmet"],[-1,"D"],[1," d"],[0,"etect"],[-1,"ed(): boolean {\n    for (let id of HELMET_IDS) {\n    "],[1,"ion\n    // isLearned(ID) checks if the ID has been taught to the HuskyLens\n    // isAppear(ID, type) checks if that specific learned ID is currently visible\n"],[0,"    "]],"start1":416,"start2":416,"length1":282,"length2":832},{"diffs":[[0,"Learned("],[-1,"id"],[1,"HELMET_ID"],[0,") && hus"]],"start1":1264,"start2":1264,"length1":18,"length2":25},{"diffs":[[0,"sAppear("],[-1,"id"],[1,"HELMET_ID"],[0,", HUSKYL"]],"start1":1297,"start2":1297,"length1":18,"length2":25},{"diffs":[[0,"    "],[-1,"    return true\n        }\n    }\n    return false\n}\n\n// ---------- MAIN LOOP ----------\nbasic.forever(function () {\n    huskylens.request()\n\n    let helmetNowDetected = isAnyHelmetDetected()\n\n    if (helmetNowDetected && !helmetDetected) {\n"],[1,"if (!helmetDetected) { // Only do these actions on the first detection\n    "],[0,"    "]],"start1":1367,"start2":1367,"length1":247,"length2":83},{"diffs":[[0," = true\n"],[1,"    "],[0,"        "]],"start1":1468,"start2":1468,"length1":16,"length2":20},{"diffs":[[0,"mMotor.AllMotor)"],[-1,"\n"],[1," // Stop the car\n    "],[0,"        maqueenP"]],"start1":1538,"start2":1538,"length1":33,"length2":53},{"diffs":[[0,"pen)"],[-1,"\n        basic.showIcon(IconNames.No)"],[1," // Turn ON Maqueen's onboard LEDs\n            basic.showIcon(IconNames.No) // Indicate helmet detected\n        }"],[0,"\n   "]],"start1":1668,"start2":1668,"length1":45,"length2":121},{"diffs":[[0,"lse "],[1,"{\n        "],[0,"if ("],[-1,"!"],[0,"helmet"],[-1,"Now"],[0,"Detected"],[-1," && helmetD"],[1,") { // Only do these if it was previously d"],[0,"etected"],[-1,") {\n"],[1,"\n    "],[0,"    "]],"start1":1793,"start2":1793,"length1":52,"length2":91},{"diffs":[[0,"etected = false\n"],[1,"    "],[0,"        maqueenP"]],"start1":1895,"start2":1895,"length1":32,"length2":36},{"diffs":[[0,"ose)"],[-1,"\n        basic.clearScreen()\n    }\n\n    if (!helmetDetected && manualControlActive && (input.runningTime() - lastGamepadCommandTime > GAMEPAD_TIMEOUT_MS)) {\n        manualControlActive = false\n        maqueenPlusV2.controlMotorStop(maqueenPlusV2.MyEnumMotor.AllMotor)\n        basic.showIcon(IconNames.Asleep)\n    }\n\n    if (!helmetDetected && !manualControlActive) {\n    }\n}"],[1," // Turn OFF Maqueen's onboard LEDs\n            basic.clearScreen() // Clear icon (or show something else)\n            // If gamepad was active, it will resume control via radio handler.\n            // If gamepad is idle, car will remain stopped (see below).\n        }\n    }\n\n    // 3. Handle gamepad timeout\n    // If no command from gamepad for a while, and no helmet, stop the car.\n    if (!helmetDetected && manualControlActive && (input.runningTime() - lastGamepadCommandTime > GAMEPAD_TIMEOUT_MS)) {\n        manualControlActive = false\n        maqueenPlusV2.controlMotorStop(maqueenPlusV2.MyEnumMotor.AllMotor)\n        basic.showIcon(IconNames.Asleep) // Indicate gamepad timed out\n    }\n\n    // If no helmet and gamepad is not active, ensure car is stopped.\n    if (!helmetDetected && !manualControlActive) {\n        maqueenPlusV2.controlMotorStop(maqueenPlusV2.MyEnumMotor.AllMotor)\n        // You could clear the icon or show a \"waiting\" icon if basic.clearScreen() above is too blank\n    }\n    basic.pause(50) // Small delay to prevent overwhelming the system\n})\n\n// ---------- RADIO RECEPTION (from Gamepad) ----------\nradio.onReceivedString(function (receivedString: string) {\n    lastGamepadCommandTime = input.runningTime() // Update timestamp for timeout\n    manualControlActive = true\n\n    if (helmetDetected) {\n        // If helmet is detected, stop motors and ignore gamepad movement commands\n        maqueenPlusV2.controlMotorStop(maqueenPlusV2.MyEnumMotor.AllMotor)\n        basic.showIcon(IconNames.No) // Re-assert helmet detection display\n        return // Exit early\n    }\n\n    // If no helmet, process gamepad commands\n    basic.showLeds(`\n        . . . . .\n        . . # . .\n        . # . # .\n        . . # . .\n        . . . . .\n        `) // Indicate radio command received and being processed\n\n    if (receivedString == \"F\") {\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.AllMotor, maqueenPlusV2.MyEnumDir.Forward, 150) // Speed 0-255\n    } else if (receivedString == \"B\") {\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.AllMotor, maqueenPlusV2.MyEnumDir.Backward, 150)\n    } else if (receivedString == \"L\") {\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.LeftMotor, maqueenPlusV2.MyEnumDir.Backward, 100)\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.RightMotor, maqueenPlusV2.MyEnumDir.Forward, 100)\n    } else if (receivedString == \"R\") {\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.LeftMotor, maqueenPlusV2.MyEnumDir.Forward, 100)\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.RightMotor, maqueenPlusV2.MyEnumDir.Backward, 100)\n    } else if (receivedString == \"S\") {\n        maqueenPlusV2.controlMotorStop(maqueenPlusV2.MyEnumMotor.AllMotor)\n    } else if (receivedString == \"LED_L_ON\") {\n        maqueenPlusV2.controlLED(maqueenPlusV2.MyEnumLed.LeftLed, maqueenPlusV2.MyEnumSwitch.Open)\n    } else if (receivedString == \"LED_L_OFF\") {\n        maqueenPlusV2.controlLED(maqueenPlusV2.MyEnumLed.LeftLed, maqueenPlusV2.MyEnumSwitch.Close)\n    } else if (receivedString == \"LED_R_ON\") {\n        maqueenPlusV2.controlLED(maqueenPlusV2.MyEnumLed.RightLed, maqueenPlusV2.MyEnumSwitch.Open)\n    } else if (receivedString == \"LED_R_OFF\") {\n        maqueenPlusV2.controlLED(maqueenPlusV2.MyEnumLed.RightLed, maqueenPlusV2.MyEnumSwitch.Close)\n    }\n    // Add more commands for RGB LEDs if desired, e.g., using maqueenPlusV2.rgb()\n    // e.g., if (receivedString == \"RGB_RED\") { maqueenPlusV2.setBrightness(100); maqueenPlusV2.rgb(100,0,0) }\n})"]],"start1":2009,"start2":2009,"length1":378,"length2":3562}]}]},{"timestamp":1749551409061,"editorVersion":"7.0.61","changes":[{"type":"edited","filename":"main.ts","patch":[{"diffs":[[0,") {\n"],[-1,"        maqueenPlusV2.controlMotorStop(maqueenPlusV2.MyEnumMotor.AllMotor)\n    }\n\n    basic.pause(50)\n})\n\n// ---------- RADIO RECEPTION (from Gamepad) ----------\nradio.onReceivedString(function (receivedString: string) {\n    lastGamepadCommandTime = input.runningTime()\n    manualControlActive = true\n\n    if (helmetDetected) {\n        maqueenPlusV2.controlMotorStop(maqueenPlusV2.MyEnumMotor.AllMotor)\n        basic.showIcon(IconNames.No)\n        return\n    }\n\n    basic.showLeds(`\n        . . . . .\n        . . # . .\n        . # . # .\n        . . # . .\n        . . . . .\n    `)\n\n    if (receivedString == \"F\") {\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.AllMotor, maqueenPlusV2.MyEnumDir.Forward, 150)\n    } else if (receivedString == \"B\") {\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.AllMotor, maqueenPlusV2.MyEnumDir.Backward, 150)\n    } else if (receivedString == \"L\") {\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.LeftMotor, maqueenPlusV2.MyEnumDir.Backward, 100)\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.RightMotor, maqueenPlusV2.MyEnumDir.Forward, 100)\n    } else if (receivedString == \"R\") {\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.LeftMotor, maqueenPlusV2.MyEnumDir.Forward, 100)\n        maqueenPlusV2.controlMotor(maqueenPlusV2.MyEnumMotor.RightMotor, maqueenPlusV2.MyEnumDir.Backward, 100)\n    } else if (receivedString == \"S\") {\n        maqueenPlusV2.controlMotorStop(maqueenPlusV2.MyEnumMotor.AllMotor)\n    } else if (receivedString == \"LED_L_ON\") {\n        maqueenPlusV2.controlLED(maqueenPlusV2.MyEnumLed.LeftLed, maqueenPlusV2.MyEnumSwitch.Open)\n    } else if (receivedString == \"LED_L_OFF\") {\n        maqueenPlusV2.controlLED(maqueenPlusV2.MyEnumLed.LeftLed, maqueenPlusV2.MyEnumSwitch.Close)\n    } else if (receivedString == \"LED_R_ON\") {\n        maqueenPlusV2.controlLED(maqueenPlusV2.MyEnumLed.RightLed, maqueenPlusV2.MyEnumSwitch.Open)\n    } else if (receivedString == \"LED_R_OFF\") {\n        maqueenPlusV2.controlLED(maqueenPlusV2.MyEnumLed.RightLed, maqueenPlusV2.MyEnumSwitch.Close)\n"],[0,"    }\n}"],[-1,")\n"]],"start1":1812,"start2":1812,"length1":2115,"length2":11}]}]},{"timestamp":1749552242366,"editorVersion":"7.0.61","changes":[{"type":"edited","filename":"main.ts","patch":[{"diffs":[[-1,"1105"],[0,"// -"]],"start1":0,"start2":0,"length1":8,"length2":4}]}]},{"timestamp":1749552605672,"editorVersion":"7.0.61","changes":[{"type":"edited","filename":"main.blocks","patch":[{"diffs":[[0,"iables><"],[1,"block type=\"pxt-on-start\" x=\"0\" y=\"0\"></block><block type=\"device_forever\" x=\"205\" y=\"0\"></block><"],[0,"/xml>"]],"start1":71,"start2":71,"length1":13,"length2":111}]},{"type":"edited","filename":"pxt.json","patch":[{"diffs":[[0," ],\n"],[-1,"    \"testFiles\": [\n        \"test.ts\"\n    ],\n"],[0,"    "]],"start1":383,"start2":383,"length1":52,"length2":8}]},{"type":"added","filename":"test.ts","value":"// tests go here; this will not be compiled when this package is used as an extension.\n"}]}],"snapshots":[{"timestamp":1749545969365,"editorVersion":"7.0.61","text":{"main.blocks":"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>","main.ts":"\n","README.md":"","pxt.json":"{\n    \"name\": \"Project HoofdZaak\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"additionalFilePaths\": []\n}\n"}},{"timestamp":1749550291884,"editorVersion":"7.0.61","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"></block><block type=\"device_forever\" x=\"205\" y=\"0\"></block></xml>","main.ts":"","README.md":"","pxt.json":"{\n    \"name\": \"Project HoofdZaak\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\",\n        \"Huskylens\": \"github:dfrobot/pxt-dfrobot_huskylens#v2.0.7\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"preferredEditor\": \"blocksprj\"\n}\n"}},{"timestamp":1749552242366,"editorVersion":"7.0.61","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"></block><block type=\"device_forever\" x=\"205\" y=\"0\"></block></xml>","main.ts":"// ---------- VARIABLES ----------\nlet helmetDetected: boolean = false\nlet manualControlActive: boolean = false\nlet lastGamepadCommandTime: number = 0\nconst GAMEPAD_TIMEOUT_MS: number = 1000 // If no command for 1 sec, assume gamepad is idle\n\n// ---------- CONSTANTS ----------\nconst HELMET_IDS: number[] = [1, 2, 3, 4] // << Adjust to match your helmet IDs\n\n// ---------- INITIALIZATION ----------\nmaqueenPlusV2.I2CInit()\nhuskylens.initI2c()\nhuskylens.initMode(protocolAlgorithm.OBJECTCLASSIFICATION)\nradio.setGroup(1)\nbasic.showIcon(IconNames.Happy)\n\n// ---------- HELPER FUNCTION ----------\nfunction isAnyHelmetDetected(): boolean {\n    for (let id of HELMET_IDS) {\n        if (huskylens.isLearned(id) && huskylens.isAppear(id, HUSKYLENSResultType_t.HUSKYLENSResultBlock)) {\n            return true\n        }\n    }\n    return false\n}\n\n// ---------- MAIN LOOP ----------\nbasic.forever(function () {\n    huskylens.request()\n\n    let helmetNowDetected = isAnyHelmetDetected()\n\n    if (helmetNowDetected && !helmetDetected) {\n        helmetDetected = true\n        maqueenPlusV2.controlMotorStop(maqueenPlusV2.MyEnumMotor.AllMotor)\n        maqueenPlusV2.controlLED(maqueenPlusV2.MyEnumLed.AllLed, maqueenPlusV2.MyEnumSwitch.Open)\n        basic.showIcon(IconNames.No)\n    } else if (!helmetNowDetected && helmetDetected) {\n        helmetDetected = false\n        maqueenPlusV2.controlLED(maqueenPlusV2.MyEnumLed.AllLed, maqueenPlusV2.MyEnumSwitch.Close)\n        basic.clearScreen()\n    }\n\n    if (!helmetDetected && manualControlActive && (input.runningTime() - lastGamepadCommandTime > GAMEPAD_TIMEOUT_MS)) {\n        manualControlActive = false\n        maqueenPlusV2.controlMotorStop(maqueenPlusV2.MyEnumMotor.AllMotor)\n        basic.showIcon(IconNames.Asleep)\n    }\n\n    if (!helmetDetected && !manualControlActive) {\n    }\n}","README.md":"","pxt.json":"{\n    \"name\": \"Project HoofdZaak\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\",\n        \"Huskylens\": \"github:dfrobot/pxt-dfrobot_huskylens#v2.0.7\",\n        \"maqueenPlusV2\": \"github:dfrobot/pxt-dfrobot_maqueenplus_v20#v2.2.20\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n"}}],"shares":[],"lastSaveTime":1749552725325}